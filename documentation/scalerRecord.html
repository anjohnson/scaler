<HTML>
<HEAD>
<TITLE>Scaler Record (v 3.2) and related software</TITLE>
</HEAD>
<BODY>
<H1>Scaler Record (v 3.2) and related software</H1>

<ADDRESS>Tim Mooney</ADDRESS>

<HR>
<H2>Contents</H2>
<UL>
<LI><A HREF="#Overview">Overview</A>
<LI><A HREF="#Fields">Field Descriptions</A>
<LI><A HREF="#Files">Files, device-support</A>
<LI><A HREF="#Restrictions">Restrictions</A>
</UL>

<A NAME="Overview">
<H2>Overview</H2></A>

<P>This documentation describes version 3.2 of the EPICS scaler record,
and related EPICS software required to build and use it.  This version
of the record is compatible with EPICS 3.13.0, and is incompatible with
any earlier version of EPICS.

<P>The scaler record provides support for a bank of up to 16 32-bit
counters (scaler channels) controlled by a common start/stop
mechanism.  The record divides scaler channels into two groups according
to the values of each channel's gate-control field (Gn): simple
counters [Gn = "N" (0)], and preset counters [Gn = "Y" (1)].  Simple counters are zeroed immediately
before counting begins, and count upwards.  Preset counters are simple
counters that will not count higher than a preset value.  The first
preset counter to reach its preset value stop all counters.  (The
hardware may actually implement a preset counter by loading in the
preset value, and counting down to zero.  If so, device support is
expected to maintain the fiction that all counters count up from
zero.)  Currently device support exists for the Joerger VSC8 and VSC16
family of VME scalers (TTL, NIM, and ECL versions).

<P>Scaler channel 1 receives special treatment: it is presumed to count a
fixed-frequency clock signal, and its value is presumed to indicate the
time interval during which counting was enabled.  The fields 
<UL>
<LI>T (time)
<LI>TP (time preset)
<LI>S1 (scaler channel 1 value)
<LI>PR1 (scaler channel 1 preset value), and
<LI>FREQ (clock frequency)
</UL> satisfy the following equations:
<PRE>
	T = S1 / FREQ
	TP = PR1 / FREQ
</PRE>
It is the user's job to make sure that FREQ actually contains the
frequency of the clock signal input to scaler channel 1.

<P>Scaler channel 1 does not have to be used in this way: if FREQ, TP, and T are
ignored, then this counter behaves like any other counter.

<P>This is how the scaler record is intended to be used:
<OL>
<LI>The user sets FREQ to the frequency of the clock signal input to
   scaler channel 1.
<LI>The user sets TP (time preset) and/or PRn (preset value for scaler channel n)
<LI>The user sets CNT to "Count" (1), initiating counting.
<LI>The counters count until one of them reaches its preset value, whereupon
   the record resets CNT to "Done" (0), or the user manually resets CNT to
   "Done" (0), causing couting to stop.
</OL>

<P>This version of the scaler record maintains two counting modes:
normal and background (also called AutoCount).  Normal counting is
controlled by the CNT ("Count/Done") field, the time preset, and other
presets, as described above.  Background counting is controlled by the
CONT ("OneShot/AutoCount") field, normally ignores user preset values,
and is intended to give the user continuous updates whenever the scaler
would otherwise be idle.

<P>When CONT = "AutoCount" (1), and no normal counting operation is
already in progress, the scaler waits for the AutoCount delay (DLY1);
counts for the AutoCount period (TP1); and displays the result.  If the
AutoCount period (TP1) is less than .001 s, we default to the normal
criteria for determining the count period.  If the AutoCount Display
Rate (RAT1) is greater than zero (Hz), then the scaler values are
displayed at that rate while background counting is in progress.
Background counting is interrupted immediately whenever a normal
counting operation is started with the CNT field, and the results of a
normal counting operation are held for one second after the scaler
finishes that operation before background counting begins again.
Background counting never affects the state of the CNT field, so this
field can always be used to determine when a normal counting operation
has begun and finished.

<P>The scaler record is unlike most other EPICS records in that its
processing is neither "synchronous" nor "asynchronous", as these terms
are used in the EPICS Record Reference Manual.  Currently, the PACT
field is always FALSE after record processing has completed, even
though the scaler may be counting.  This means the record always
responds to channel-access puts, and that counting can be stopped at
any time.  The record's forward link is not executed until the scaler
has stopped counting.


<A NAME="Fields">
<H2>Field Descriptions</H2></A>
<P>In addition to fields common to all record types (see the <A
HREF="http://www.atdiv.lanl.gov/aot8/epics/dbase/recref/rcrf-1.html">EPICS
Record Reference Manual</A> for these) the scaler record has the fields
described below.
<UL>
<LI><A HREF="#Fields_alphabetical">Alphabetical listing of all fields</A>
<LI><A HREF="#Fields_control">Control/status fields:</A>
<LI><A HREF="#Fields_data">Data fields</A>
<LI><A HREF="#Fields_link">Link fields</A>
<LI><A HREF="#Fields_misc">Miscellaneous fields</A>
<LI><A HREF="#Fields_private">Private fields</A>
</UL>

<HR>
<TABLE BORDER CELLPADDING=1>
<A NAME="Fields_alphabetical">
<CAPTION><H2>Alphabetical list of record-specific fields</H2>
NOTE: Hot links in this table take you only to the <EM>section</EM> in which
the linked item is described in detail.  You'll probably have to scroll down to
find the actual item.</CAPTION></A>

<TR>								<TH>Name		<TH>Access	<TH>Prompt				<TH>Data type	<TH>Comment

<TR><TD><A HREF="#Fields_misc">		CARD	</A> 	<TD>R		<TD>Card Number			<TD>SHORT		<TD>Which VME card
<TR><TD><A HREF="#Fields_control">	CNT		</A>	<TD>R/W*	<TD>Count				<TD>RECCHOICE	<TD>(0:"Done", 1:"Count")
<TR><TD><A HREF="#Fields_control">	CONT	</A>	<TD>R/W*	<TD>OneShot/AutoCount	<TD>RECCHOICE	<TD>(0:"OneShot", 1:"AutoCount")
<TR><TD><A HREF="#Fields_private">	D1...D16</A>	<TD>R/W		<TD>Count Direction n	<TD>RECCHOICE	<TD>(0:"Up", 1:"Dn")
<TR><TD><A HREF="#Fields_control">	DLY		</A>	<TD>R/W		<TD>Delay				<TD>FLOAT		<TD>before counting
<TR><TD><A HREF="#Fields_control">	DLY1		</A>	<TD>R/W		<TD>Auto-mode Delay				<TD>FLOAT		<TD>before counting
<TR><TD><A HREF="#Fields_misc">		EGU		</A>	<TD>R/W		<TD>Units Name			<TD>STRING		<TD>8 characters
<TR><TD><A HREF="#Fields_data">		FREQ	</A>	<TD>R/W		<TD>Time base freq		<TD>DOUBLE		<TD>e.g., 1e7
<TR><TD><A HREF="#Fields_control">	G1...G16</A>	<TD>R/W		<TD>Gate Control n		<TD>RECCHOICE	<TD>preset? (0:"N", 1:"Y")
<TR><TD><A HREF="#Fields_misc">		NCH		</A>	<TD>R		<TD>Number of Channels	<TD>SHORT		<TD>from device
<TR><TD><A HREF="#Fields_misc">		NM1...NM16</A>	<TD>R/W		<TD>Scaler n name		<TD>STRING		<TD>user's field
<TR><TD><A HREF="#Fields_link">		OUT		</A>	<TD>R		<TD>Output Specification<TD>OUTLINK		<TD>link to hardware
<TR><TD><A HREF="#Fields_private">	PCNT	</A>	<TD>R		<TD>Prev Count			<TD>RECCHOICE	<TD>private
<TR><TD><A HREF="#Fields_misc">		PREC	</A>	<TD>R/W		<TD>Display Precision	<TD>SHORT		<TD>num decimal places
<TR><TD><A HREF="#Fields_control">	PR1...PR16</A>	<TD>R/W		<TD>Preset n			<TD>LONG		<TD>preset values
<TR><TD><A HREF="#Fields_control">	RATE	</A>	<TD>R/W		<TD>Display Rate (Hz.)	<TD>FLOAT		<TD>in [0..60] Hz
<TR><TD><A HREF="#Fields_control">	RAT1	</A>	<TD>R/W		<TD>Auto Display Rate (Hz.)	<TD>FLOAT		<TD>in [0..60] Hz
<TR><TD><A HREF="#Fields_data">		S1...S16</A>	<TD>R		<TD>Scaler n			<TD>LONG		<TD>results
<TR><TD><A HREF="#Fields_private">	SS</A>			<TD>r		<TD>Scaler state		<TD>SHORT		<TD>state of hardware
<TR><TD><A HREF="#Fields_data">		T		</A>	<TD>R		<TD>Timer				<TD>DOUBLE		<TD>elapsed time
<TR><TD><A HREF="#Fields_control">	TP		</A>	<TD>R/W		<TD>Time Preset			<TD>DOUBLE		<TD>preset time
<TR><TD><A HREF="#Fields_control">	TP1		</A>	<TD>R/W		<TD>Time Preset			<TD>DOUBLE		<TD>preset time (auto mode)
<TR><TD><A HREF="#Fields_private">	US</A>			<TD>r		<TD>User state			<TD>SHORT		<TD>state of user request
<TR><TD><A HREF="#Fields_private">	VAL		</A>	<TD>R/W		<TD>Result				<TD>DOUBLE		<TD>not used
<TR><TD><A HREF="#Fields_misc">		VERS	</A>	<TD>R		<TD>Code Version		<TD>FLOAT		<TD>code version

<TR VALIGN=TOP>
<TD COLSPAN=5, ALIGN=LEFT>
<TABLE>
<TD COLSPAN=3> Note: In the <B>Access</B> column above: </TD>
<TR VALIGN=TOP>
<TD>R</TD>    <TD>Read only<TD>
</TR>
<TR VALIGN=TOP>
<TD>r</TD>    <TD>Read only, not posted<TD>
</TR>
<TR VALIGN=TOP>
<TD>R/W</TD>  <TD>Read and write are allowed</TD>
</TR>
<TR VALIGN=TOP>
<TD>R/W*</TD> <TD>Read and write are allowed; write triggers record 
processing if the record's SCAN field is set to "Passive."</TD>
</TR>
<TR VALIGN=TOP>
<TD>N</TD>    <TD>No access allowed</TD>
</TR>
</TABLE>

</TABLE>
</HR>


<HR>
<TABLE BORDER CELLPADDING=5>
<A NAME="Fields_control">
<CAPTION><H2>Control/status fields</H2></CAPTION></A>
<TR VALIGN=TOP><TH>Name	<TH>Access	<TH>Prompt				<TH>Data type		<TH>Comments

<TR VALIGN=TOP><TD>CNT	<TD>R/W*	<TD>Count	<TD>RECCHOICE <TD>(0:"Done", 1:"Count")
	<TR><TD COLSPAN=5>
User sets this field to "Count" (1) to start counting.  When a preset is reached,
counting will stop, this field will be reset to "Done" (0), and the forward
link will be fired.  If this field is set to "Done" (0) while counting is in
progress, counting will be stopped, the accumulated counts will be reported,
and the forward link will be fired.

<TR VALIGN=TOP><TD>CONT	<TD>R/W*	<TD>OneShot/AutoCount	<TD>RECCHOICE <TD>(0:"OneShot", 1:"AutoCount")
	<TR><TD COLSPAN=5>
User sets this field to "AutoCount" (1) to enable background counting.
(See also autocount delay (DLY1), autocount display rate (RAT1), and autocount time presetTP1.)

<TR VALIGN=TOP><TD>G1...G16	<TD>R/W	<TD>Gate control	<TD>RECCHOICE <TD>(0:"N", 1:"Y")

	<TR><TD COLSPAN=5>
There are 16 of these fields, one per channel.  These fields determine
whether the associated scalers are to be used as simple scalers (Gn=0)
or preset scalers (Gn=1).  When Gn is set to 1, the record will ensure
than PRn is nonzero (will set it to 1000, if it was zero).  When PRn is
set to any positive value, the record will set Gn to 1.

<TR VALIGN=TOP><TD>PR1...PR16	<TD>R/W	<TD>Preset n	<TD>LONG

	<TR><TD COLSPAN=5>
Preset values for the associated scalers.  If scaler n has been
designated as a preset scaler (i.e., if Gn=1), then when the scaler
reaches the count PRn, all scalers will be disabled, and the record
will report counting has completed by setting CNT=0.  If scaler n has
not been designated as a preset scaler, the PRn is ignored.  When PRn
changes to any positive value, the record will set Gn to 1.

<TR VALIGN=TOP><TD>TP	<TD>R/W	<TD>Time preset	<TD>DOUBLE

	<TR><TD COLSPAN=5>
This field specifies for how long, in seconds, the scaler is to count
if no other preset stops it.  TP is effectively a proxy for the preset
field, PR1, associated with scaler 1.  Whenever TP changes, the record
will set PR1 = TP*FREQ, and otherwise behave as though the user had
changed PR1.

<TR VALIGN=TOP><TD>TP1	<TD>R/W	<TD>AutoCount Time preset	<TD>DOUBLE

	<TR><TD COLSPAN=5>
This field specifies the background-counting period in seconds.

<TR VALIGN=TOP><TD>DLY	<TD>R/W	<TD>Delay (sec)		<TD>FLOAT

	<TR><TD COLSPAN=5>
The delay, in seconds, that the record is to wait after
CNT goes to 1 before actually causing counting to begin.

<TR VALIGN=TOP><TD>DLY1	<TD>R/W	<TD>AutoCount Delay (sec)		<TD>FLOAT

	<TR><TD COLSPAN=5>
The delay, in seconds, between successive background-counting periods.

<TR VALIGN=TOP><TD>RATE	<TD>R/W	<TD>Display rate (Hz.)		<TD>FLOAT

	<TR><TD COLSPAN=5>
This field specifies the rate in Hz. at which the scaler record posts
scaler information while counting is in progress.  If this field is
zero, counts are displayed only after counting has stopped.  Max.
rate:  60 Hz.

<TR VALIGN=TOP><TD>RAT1	<TD>R/W	<TD>AutoCount Display rate (Hz.)		<TD>FLOAT

	<TR><TD COLSPAN=5>
This field specifies the rate in Hz. at which the scaler record posts
scaler information while background counting is in progress.  If this field is
zero, counts are displayed only after background counting has stopped.  Max.
rate:  60 Hz.

<TR VALIGN=TOP><TD><TD><TD><TD><TD>
</TABLE>


<HR>
<TABLE BORDER CELLPADDING=5>
<A NAME="Fields_data">
<CAPTION><H2>Data fields</H2></CAPTION></A>
<TR VALIGN=TOP><TH>Name	<TH>Access	<TH>Prompt				<TH>Data type		<TH>Comments

<TR VALIGN=TOP><TD>FREQ	<TD>R/W	<TD>Time base freq. (EGU)		<TD>DOUBLE

	<TR><TD COLSPAN=5>
The frequency (in Hz) of the clock signal counted by scaler 1.  The
record uses this field to convert between time values (T and TP, in
seconds) and values associated with scaler 1 (S1 and PR1).  It is
the user's responsibility to ensure that this field has the correct
value.

<TR VALIGN=TOP><TD>S1...S16	<TD>R	<TD>Scaler n value (EGU)		<TD>LONG

	<TR><TD COLSPAN=5>
The counts accumulated by the scalers.  These are posted periodically (at RATE Hz.)
while counting is in progress, and once after counting stops.

<TR VALIGN=TOP><TD>T	<TD>R	<TD>Timer (EGU)		<TD>DOUBLE

	<TR><TD COLSPAN=5>
This field is a proxy for the value field, S1, associated with scaler
1.  Whenever S1 changes, the record will set T = S1/FREQ.


</TABLE>
</HR>

<HR>
<TABLE BORDER CELLPADDING=5>
<A NAME="Fields_link">
<CAPTION><H2>Link fields</H2></CAPTION></A>
<TR VALIGN=TOP><TH>Name	<TH>Access	<TH>Prompt				<TH>Data type		<TH>Comments

<TR VALIGN=TOP><TD>OUT	<TD>R	<TD>Output Specification	<TD>OUTLINK

	<TD>This field specifies the hardware to be controlled.

</TABLE>
</HR>


<HR>
<TABLE BORDER CELLPADDING=5>
<A NAME="Fields_misc">
<CAPTION><H2>Miscellaneous fields</H2></CAPTION></A>
<TR VALIGN=TOP><TH>Name	<TH>Access	<TH>Prompt				<TH>Data type		<TH>Comments

<TR VALIGN=TOP><TD>NM1...NM16	<TD>R/W		<TD>Scaler n name		<TD>STRING

	<TD>Names the user has given to individual scaler channels.

<TR VALIGN=TOP><TD>PREC	<TD>R/W		<TD>Display Precision		<TD>SHORT

	<TD>The number of digits to the right of the decimal that are to be
	displayed by MEDM and other channel-access clients.

<TR VALIGN=TOP><TD>EGU	<TD>R/W		<TD>Engineering Units		<TD>STRING

	<TD>String sent to channel-access clients who ask for engineering units.

<TR VALIGN=TOP><TD>VERS	<TD>R		<TD>Code Version			<TD>FLOAT

	<TD>Version number of the recScaler.c code.

<TR VALIGN=TOP><TD>CARD	<TD>R		<TD>Card Number				<TD>SHORT

	<TR><TD COLSPAN=5>
The VME card number, derived from the output link.  Cards are numbered
from zero according to their VME addresses.  Joerger-scaler types VSC8
and VSC16 are in the same series, since they are handled by the same
device-support module.

<TR VALIGN=TOP><TD>NCH	<TD>R		<TD>Number of channels				<TD>SHORT

	<TD>
The number of channels actually supported by the underlying hardware,
as reported by device support.

</TABLE>
</HR>
<HR>

<TABLE BORDER CELLPADDING=5>
<A NAME="Fields_private">
<CAPTION><H2>Private fields</H2></CAPTION></A>
<TR VALIGN=TOP><TH>Name	<TH>Access	<TH>Prompt				<TH>Data type		<TH>Comments

<TR VALIGN=TOP><TD>D1...D16 	<TD>R/W	<TD>Count direction	<TD>RECCHOICE 		<TD>(0:"Up", 1:"Dn")

	<TR><TD COLSPAN=5>
These fields are intended for the private use of the record, and may
disappear or become read-only in the future.  For scaler n, Dn is
direction in which the hardware actually counts.

<TR VALIGN=TOP><TD>PCNT 		<TD>R/W	<TD>Previous count	<TD>RECCHOICE 		<TD>(0:"Done", 1:"Count")

	<TR><TD COLSPAN=5>
Previous value of CNT.

<TR VALIGN=TOP><TD>SS 		<TD>r	<TD>Scaler state	<TD>SHORT		<TD>state of hardware

	<TR><TD COLSPAN=5>

<TR VALIGN=TOP><TD>US 		<TD>r	<TD>User state	<TD>SHORT		<TD>state of user's request

	<TR><TD COLSPAN=5>

<TR VALIGN=TOP><TD>VAL 			<TD>R/W	<TD>Result			<TD>DOUBLE 			<TD>Not used.

</TABLE>
</HR>






<HR>
<P>
<A NAME="Files"><H2>Files, device support</H2></A> The following table
briefly describes all of the files required to implement and use the
scaler record.  The reader is assumed to be familiar with the <A
HREF="http://www.aps.anl.gov/asd/controls/epics/EpicsDocumentation/AppDevManuals/iocAppBuildSRcontrol.html">
IOC Applications: Building and Source/Release Control document</A> which describes
how to build an EPICS application tree into which these files are to be
placed, and how to run "gnumake" to build record and device
support. These files can all be
obtained from the <A HREF="http://www.aps.anl.gov/xfd/WWW/xfd/SoftDist/Welcome.html"> EPICS Software Distribution</A> (in the <A HREF="http://www.aps.anl.gov/xfd/WWW/xfd/SoftDist/Welcome.html#Custom_EPICS"> custom-software section</A>).

<P>
<TABLE BORDER CELLPADDING=5>
<TR><TH COLSPAN=2>
SOURCE CODE<BR>
files to be placed in <CODE>&lt;top&gt;/&lt;app&gt;App/src/</CODE>
</TH> </TR>
<TR VALIGN=TOP><TD>scalerRecord.c	<TD>Record support for the scaler record</TR>
<TR VALIGN=TOP><TD>devScaler.h		<TD>Header included by record and device support</TR>
<TR VALIGN=TOP><TD>devScaler.c		<TD>Device support for Joerger VSC8 and VSC16</TR>

<TR VALIGN=TOP>
<TD>scalerRecord.dbd</TD>
<TD>This file defines all of the fields menus, etc. for the scaler record.</TD>
</TR>

<TR VALIGN=TOP>
<TD>*Include.dbd</TD>
<TD>This file is not included in the distribution.  However, the user must edit
this file and add the following lines:
<PRE>
# Database definition for scaler record
include "scalerRecord.dbd"
# Device support for scaler record
device(scaler,VME_IO,devScaler,"Joerger VSC8/16")
</PRE></TD>
</TR>

<TR VALIGN=TOP>
<TD>Makefile.Vx</TD>
<TD>This file is not included in the distribution.  However, the user must edit
this file and add, for example, the following lines:
<PRE>

RECTYPES += scalerRecord.h
SRCS.c += ../scalerRecord.c ../devScaler.c
PROD += scalerRecord.o
PROD += devScaler.o

</PRE></TD>
</TR>
</TABLE>




<P><TABLE BORDER CELLPADDING=5>
<TR><TH COLSPAN=2>MEDM DISPLAY SCREENS<BR>
files to be placed in 
<CODE>&lt;top&gt;/&lt;app&gt;App/op/adl/</CODE>
</TH> </TR>
<TR VALIGN=TOP><TD>scaler.adl		<TD>tiny operator screen for 8-channel scaler
<TR VALIGN=TOP><TD>scaler16.adl		<TD>same, but for 16-channel scaler
<TR VALIGN=TOP><TD>scaler_more.adl		<TD>medium operator screen
<TR VALIGN=TOP><TD>scaler16_more.adl	<TD>same, but for 16-channel scaler
<TR VALIGN=TOP><TD>scaler_full.adl		<TD>big operator screen
<TR VALIGN=TOP><TD>scaler16_full.adl	<TD>same, but for 16-channel scaler
<TR VALIGN=TOP><TD>scaler_full_calc.adl	<TD>big operator screen with user calculations
<TR VALIGN=TOP><TD>scaler16_full_calc.adl	<TD>same, but for 16-channel scaler

<TR><TD COLSPAN=2>These files build <CODE>medm</CODE> screens to access the scaler record
and related process variables in the database included with this distribution.
To use one of them from the command line, type, for example
<PRE>
medm -x -macro "P=XXX:,S=scaler1" scaler.adl
</PRE>
<P>
where <CODE>XXX:scaler1</CODE> is the name of a scaler record in an IOC.
<P>
These files can also be used as related displays from other <CODE>medm</CODE>
screens by passing the argument <CODE>"P=XXX:,S=scaler1"</CODE>.
</TD>
</TR>
</TABLE>


<P><TABLE BORDER CELLPADDING=5>
<TR><TH COLSPAN=2>EPICS STARTUP FILES<BR>
files to be placed in 
<CODE>&lt;top&gt;/iocBoot/ioc&lt;name&gt;/</CODE>
</TH> </TR>

<TR VALIGN=TOP><TD>st.cmd		<TD>Startup script
<TR><TD COLSPAN=2>
This file is not included in the distribution.  Here are annotated excerpts
from a startup file that supports scalers: 
<PRE>
#######################################################################
# vxWorks startup script to load and execute system (iocCore) software.
</PRE>
<B><FONT COLOR=#FFFFFF> Load standard EPICS software</FONT></B>
<PRE>
# Load EPICS base software
ld < bin/iocCore
</PRE>

<B><FONT COLOR=#FFFFFF> Load custom EPICS software (including motor support) </FONT></B>
<PRE>
ld < bin/xxxApp.o
# Load scaler record and device support (if they're not included in xxxApp.o)
ld < bin/scalerRecord.o
ld < bin/devScaler.o
</PRE>

<B><FONT COLOR=#FFFFFF> Scaler-related databases </FONT></B>
<PRE>
# Tell EPICS all about the record types, device-support modules, drivers,
# etc. in the software we just loaded (xxxApp)
dbLoadDatabase("dbd/xxxApp.dbd")

# scalers
dbLoadRecords("xxxApp/Db/Jscaler.db","P=xxx:,S=scaler1,C=0")
dbLoadRecords("xxxApp/Db/Jscaler.db","P=xxx:,S=scaler2,C=1")
</PRE>
<FONT COLOR=#FFFFFF> <B>Specify scaler-controller board address, interrupt vector, etc.</B><BR>
<TABLE BORDER CELLPADDING=5>
<TR><TH COLSPAN=2><PRE>
#VSCSetup(nCards, baseAddress, intVectBase)
VSCSetup(2, 0xD0000000, 200)
</PRE>
</TH>
<TR VALIGN=TOP><TD>nCards</TD>
<TD>the actual number of cards may be less, but not greater than this
</TR>
<TR VALIGN=TOP><TD>baseAddress</TD>
<TD>the base address of the first card of a series.  This must agree
with address jumpers on the actual card(s).
<P>Joerger VSC8 and VSC16 have base addresses in the A32 address space,
on a 256-byte (0x100) boundary.  (I.e., these cards require 256 bytes
each, and must all be addressed contiguously as, e.g., 0xD0000000,
0xD0000100,...).
</TD></TR>
<TR VALIGN=TOP><TD>intVectBase</TD>
<TD>the interrupt vector that will be loaded into the first card of a
series.  Succeeding cards will be loaded with intVectBase+1,
intVectBase+2, etc.  Stay in the range [64..255].  (The interrupt <EM>level</EM>
is read from the hardware.)</TD>
</TR>
</TABLE>
</FONT>

<B><FONT COLOR=#FFFFFF> Start EPICS </FONT></B>
<PRE>
iocInit
</PRE>

</CODE>
</TD>
</TR>
</TABLE>

<P><TABLE BORDER CELLPADDING=5>
<TR><TH COLSPAN=2>BACKUP/RESTORE (BURT) REQUEST FILES<BR>
files to be placed in <CODE>&lt;top&gt;/&lt;app&gt;App/op/burt/</CODE>
</TH></TR>

<TR VALIGN=TOP><TD>scalerSettings.req   <TD>sample request file to save
settings of one scaler database.  Edit this file, supplying names of
the scaler records whose settings you want saved.  (The sample file
also saves the states of other records in the sample database,
Jscaler.db, that control calculations done when the scaler finishes
counting.)
<TR VALIGN=TOP><TD>yyScalerSettings.req	<TD>save settings of a specified scaler record.  This file is <CODE>#include</CODE>'d (once for each scaler) by scalerSettings.req.

<TR><TD COLSPAN=2>These files tell the backup/restore tool how to save scaler
settings.  To use them from the command line, type, for example
<PRE>
burtrb -f scalerSettings.req -o myScalerSettings.snap<BR>
</PRE>
To restore the scaler settings saved by the above commands, type
<PRE>
burtwb -f myScalerSettings.snap<BR>
</PRE>
</TD>
</TR>

</TABLE>


<HR>
<A NAME="Restrictions"><H2>Restrictions</H2></A>
When AutoCount is enabled, with a very short counting time (TP1) and delay
time (DLY1), the scaler can swamp the network with data.<HR>

<ADDRESS>
Suggestions and comments to: 
<BR><A HREF="mailto:mooney@aps.anl.gov">Tim Mooney</A> : (mooney@aps.anl.gov)
<BR>
Last modified: November 24, 1997
</ADDRESS>

</BODY>
</HTML>
